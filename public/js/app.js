var app=app||{};app.define=function(e){var t,i=e.split("."),n=app;for("app"==i[0]&&(i=i.slice(1)),t=0;t<i.length;t++)"undefined"==typeof n[i[t]]&&(n[i[t]]={}),n=n[i[t]];return n},app.tag=function(e){if(window.riot)return _.filter(riot.vdom,function(t){if(t.root.nodeName.toLowerCase()==e)return t})[0]},window.Store=window.store||{},window.$store={},function(e){app.define("config"),app.define("effects"),app.define("sizes"),app.define("utils"),app.define("plugins"),app.define("device"),app.define("events"),app.define("loader"),app.define("$dom"),app.$dom={html:e("html"),body:e("body"),document:e(document),window:e(window),root:e("#app")},app.events={click:document&&"ontouchstart"in document.documentElement?"tap":"click"},app.keys={LEFT:37,UP:38,RIGHT:39,DOWN:40,DEL:8,TAB:9,RETURN:13,ENTER:13,ESC:27,PAGEUP:33,PAGEDOWN:34,SPACE:32},window.KEY=app.keys,app.prefixed={transform:Modernizr.prefixed("transform"),"transform-origin":Modernizr.prefixed("transformOrigin")},$$=window.jQuery,window.moment&&moment.locale("ru"),e.fn.api=function(e){return this.data(e)?this.data(e):this.data(e,{}).data(e)}}($),window.$afterlag={run:function(e,t){var i={delay:0,iterations:1};t&&_.extend(i,t);var n=new Afterlag(i);n.run(e)},xs:function(e,t){var i={iterations:2,timeout:200};t&&_.extend(i,t),$afterlag.run(e,i)},s:function(e,t){var i={iterations:3,timeout:300};t&&_.extend(i,t),$afterlag.run(e,i)},m:function(e,t){var i={iterations:5,timeout:500};t&&_.extend(i,t),$afterlag.run(e,i)},l:function(e,t){var i={iterations:7,timeout:700};t&&_.extend(i,t),$afterlag.run(e,i)},xl:function(e,t){var i={iterations:10,timeout:1e3};t&&_.extend(i,t),$afterlag.run(e,i)}},function(e,t,i,n,o){e.define("compatible"),e.compatible={init:function(e,t){n.isPhone?n.isAndroid&&(!n.verOS||n.verOS&&n.verOS<4.4)?this.render("android"):n.isIOS&&(!n.verOS||n.verOS&&n.verOS<7)?this.render("ios"):n.isAndroid||n.isIOS?e.call(this,t):this.render("unknown"):e.call(this,t)},render:function(e){var t;"android"==e?t="Версия вашего Android должна быть не ниже 4.4":"ios"==e?t="Версия вашей iOS должна быть не ниже 7.0":"unknown"==e&&(t="К сожалению ваше устройство не поддерживается. Android не ниже 4.4 или iOS 7.0"),i.body.append('<div class="incompatible-device"><div class="incompatible-device-wrapper"><svg class="incompatible-device-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" enable-background="new 0 0 100 100" xml:space="preserve"><path fill="#fff" d="M94.553,36.928c2.689-2.691,2.689-7.07,0-9.761L70.861,3.475c-1.303-1.304-3.036-2.021-4.879-2.021  c-1.844,0-3.577,0.718-4.881,2.022L4.256,60.321c-2.689,2.69-2.689,7.069,0,9.761l23.691,23.689  c0.152,0.152,0.312,0.295,0.475,0.432H14.688c-1.327,0-2.403,1.075-2.403,2.401c0,1.327,1.076,2.403,2.403,2.403h47.691  c1.326,0,2.401-1.076,2.401-2.403c0-1.326-1.075-2.401-2.401-2.401H37.234c0.162-0.137,0.322-0.278,0.473-0.431L94.553,36.928z   M42.95,81.643L16.387,55.078c-0.016-0.016-0.035-0.025-0.051-0.041l41.975-41.974c0.016,0.016,0.026,0.035,0.042,0.051  l26.562,26.563c0.016,0.016,0.035,0.026,0.051,0.042L42.991,81.693C42.976,81.678,42.966,81.658,42.95,81.643z M65.982,6.259  c0.559,0,1.087,0.219,1.482,0.614l23.69,23.692c0.816,0.817,0.816,2.148,0,2.966l-2.802,2.801c-0.016-0.017-0.026-0.036-0.043-0.052  L61.75,9.717c-0.017-0.016-0.035-0.026-0.051-0.042L64.5,6.873C64.896,6.477,65.422,6.259,65.982,6.259z M7.655,66.684  c-0.817-0.817-0.817-2.147,0-2.965l5.293-5.295c0.015,0.018,0.026,0.036,0.042,0.053L39.552,85.04  c0.016,0.017,0.035,0.026,0.052,0.041l-5.294,5.294c-0.792,0.794-2.171,0.791-2.964-0.001L7.655,66.684z"/><path fill="#fff" d="M82.905,28.24c0.344,0.345,0.905,0.345,1.249,0.001c0.344-0.345,0.342-0.905,0-1.248l-7.246-7.246  c-0.346-0.344-0.902-0.345-1.248,0c-0.344,0.344-0.344,0.903,0,1.249L82.905,28.24z"/><circle cx="72.533" cy="16.621" r="0.842"/><circle fill="#fff" cx="22.921" cy="75.107" r="2.759"/></svg><p class="incompatible-device-text">'+t+"</p></div></div>")}}}(app,$$,app.$dom,app.device,app.utils),function(e){e.history=[],e.resources=function(t,i,n){i=i||$.noop,n=n||$.noop;for(var o=[],r=0;r<t.length;r++)e.history.indexOf(t[r])<0&&o.push(t[r]);return o.length?void Modernizr.load({load:o,callback:function(t){e.history.push(t),n()},complete:i}):i()},e.images=function(e,t,i){var n=0;t=t||$.noop,i=i||$.noop,e.imagesLoaded({background:".bg-cover"}).always(t).progress(function(e){n++,i(n,e.images.length)})}}(app.loader),function(e,t){var i=function(){e.width=t.window.width(),e.height=parseInt(window.innerHeight,10)};t.window.on("resize.app",i),i()}(app.sizes,app.$dom),function(e,t){e.support=Modernizr,e.isMobile=e.support.touch,t.html.addClass(e.isMobile?"d-mobile":"d-no-mobile"),e.isRetina=window.devicePixelRatio&&window.devicePixelRatio>1,t.html.addClass(e.isRetina?"d-retina":"d-no-retina");var i=function(){var i=t.window.width();e.isPhone=i<768,e.isTablet=i<1025&&i>767,e.orientation=e.isTablet&&i<1025&&i>991||e.isPhone&&i>480?"landscape":"portrait",t.html.addClass(e.isPhone?"d-phone":"d-no-phone").removeClass(e.isPhone?"d-no-phone":"d-phone").addClass(e.isTablet?"d-tablet":"d-no-tablet").removeClass(e.isTablet?"d-no-tablet":"d-tablet").addClass("landscape"===e.orientation?"r-landscape":"r-portrait").removeClass("landscape"!==e.orientation?"r-landscape":"r-portrait")};if(t.window.on("resize.sizeCheck",i),i(),navigator.userAgent.match(/(iPhone)/i)&&(e.isPhone=!0),navigator.userAgent.match(/iPad/i)&&(t.html.addClass("d-ipad"),e.isIPad=!0),navigator.userAgent.match(/(iPhone|iPod touch)/i)&&(t.html.addClass("d-iphone"),e.isIPhone=!0),navigator.userAgent.match(/(iPad|iPhone|iPod touch)/i)){t.html.addClass("d-ios"),e.isIOS=!0;var n=navigator.userAgent.match(/.*CPU.*OS (\d)_(\d)/i);e.verOS=!(!n||!n[1])&&n[1]+(n[2]?"."+n[2]:"")}else t.html.addClass("d-no-ios");if(navigator.userAgent.match(/.*CPU.*OS 7_\d/i)&&(t.html.addClass("d-ios7"),e.isIOS7=!0),navigator.userAgent.match(/Android/i)){t.html.addClass("d-android"),e.isAndroid=!0;var n=navigator.userAgent.match(/Android (\d)\.(\d)/i);e.verOS=!(!n||!n[1])&&n[1]+(n[2]?"."+n[2]:"")}t.html.hasClass("d-ipad d-ios7")&&t.window.on("resize orientationchange focusout",function(){window.scrollTo(0,0)}),e.isWin=navigator.platform.indexOf("Win")>-1,e.isMac=navigator.platform.indexOf("Mac")>-1,e.isLinux=navigator.platform.indexOf("Linux")>-1,t.html.addClass(e.isMac?"d-macOS":"d-no-macOS"),e.isSafari=/constructor/i.test(window.HTMLElement),t.html.addClass(e.isSafari?"d-safari":"d-no-safari"),e.isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,t.html.addClass(e.isFirefox?"d-firefox":"d-no-firefox"),e.isMobile&&window.FastClick&&"addEventListener"in document&&document.addEventListener("DOMContentLoaded",function(){FastClick.attach(document.body)},!1)}(app.device,app.$dom),function(e,t){e.light={},e.light.show=function(e,i,n,o){e[0].style.opacity=1,e[0].style[t.transform]="translateY("+Math.round(n-i*n)+"px) translateZ(0)",0==i&&(e[0].style[t.transform]="translateY(110%)")},e.light.hide=function(e,i,n,o){e[0].style.opacity=(1-.4*i).toFixed(3),e[0].style[t.transform]="translateY("+Math.round(-(o-1)*n-i*n*.5)+"px) translateZ(0)",1==i&&(e[0].style[t.transform]="translateY(-110%)"),0==i&&(e[0].style[t.transform]="translateY("+Math.round(-(o-1)*n)+"px) translateZ(0)")},e.light.move=function(e,i,n){e[0].style.opacity=1,e[0].style[t.transform]="translateY("+Math.round(-i*n)+"px) translateZ(0)"},e.space={},e.space.show=function(e,i){e[0].style.opacity=.33+.67*i;var n="";0==i?n="translate3d(110%, 0, 0)":app.device.isPhone?n="perspective(500px) translate3d("+(-8+8*i)+"%, 0, 0) rotateY("+(-6+6*i)+"deg) scale("+(.8+.2*i)+")":(n="perspective(500px) translate3d("+(-4+4*i)+"%, 0, 0) scale("+(.9+.1*i)+")",app.device.isFirefox||(n=n+"rotateY("+(-4+4*i)+"deg)")),e[0].style[t.transform]=n},e.space.hide=function(e,i){e[0].style.opacity=1,e[0].style[t.transform]="translate3d("+-100*i+"%, 0, 0)",1==i&&(e[0].style[t.transform]="translate3d(-110%, 0, 0)")},e.fold={},e.fold.show=function(e,i){e[0].style.opacity=1,e[0].style[t.transform]="translateY("+(100-100*i)+"%)"},e.fold.hide=function(e,i){e[0].style.opacity=1-.67*i,e[0].style[t.transform]="perspective(500px) translateY("+4*i+"%) rotateX("+3*-i+"deg) scale("+(1-.05*i)+")",1==i&&(e[0].style[t.transform]="translateY(-101%)")}}(app.effects,app.prefixed),function(e,t){t.init=function(i){if(i){var n,o=i.split("."),r=e;for(n=0;n<o.length;n++)r=r[o[n]];r&&"function"==typeof r.init?(r.init(),t.log("Initialize: <"+i+"> ready")):t.log("ERROR: <"+i+"> initialize")}},t.is=function(i,n){if(i){var o,r=i.split("."),a=e;for(o=0;o<r.length;o++)a=a[r[o]];a?n&&"function"==typeof n&&n():t.log("NOT found: <"+i+">")}},t.log=function(e){e&&("object"==typeof e?console.dir(e):console.log(e))},t.logger=function(e,i){e&&i&&("init"===e?t.log("Initialize: <"+i+"> ready"):"open"===e?t.log("OPEN: <"+i+">"):"close"===e?t.log("CLOSE: <"+i+">"):t.log(e+": <"+i+">"))},t.random=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},t.template=function(i,n,o){if(!e.templates[i])return void t.log("NOT found: <"+i+"> template");var r=Mustache.render(e.templates[i](),n?n:{}),a=$(r).appendTo(o?o:e.$dom.root);return a},t.copyArray=function(e){var i=null===e?null:t.isObject(e)?{}:[];for(var n in e)"object"==typeof e[n]&&"prototype"!==n?i[n]=t.copyArray(e[n]):i[n]=e[n];return i},t.sortArray=function(e,t,i){var n=_.sortBy(e,function(e){return e[t]});return"desc"===i?n.reverse():n},t.isArray=function(e){if(e&&"[object Array]"===Object.prototype.toString.call(e))return!0},t.isFunction=function(e){if(e&&"function"==typeof e)return!0},t.fixTouchScroll=function(t,i){var n=null,o=null;t.on("touchmove MSPointerMove",function(t){if(0===o){var i=t.changedTouches[0].clientY;i<n?(n=0,t.preventDefault()):e.device&&e.device.isIOS?setTimeout(function(){n=i},1e3):n=i}}),i.on("scroll",function(){o=this.scrollTop})},t.raf=function(e){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;return t?t(e):window.setTimeout(e,1e3/60)},t.caf=function(e){var t=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;t(e),e=null},t.support={transitions:Modernizr.csstransitions},t.transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},t.transEndEventName=t.transEndEventNames[Modernizr.prefixed("transition")],t.animEndEventNames={WebkitAnimation:"webkitAnimationEnd",MozAnimation:"animationend",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},t.animEndEventName=t.animEndEventNames[Modernizr.prefixed("animation")],t.onEndTransition=function(e,i){var n=function(e){if(t.support.transitions){if(e.target!=this)return;this.removeEventListener(t.transEndEventName,n)}i&&"function"==typeof i&&i.call(this)};t.support.transitions?e.addEventListener(t.transEndEventName,n):n()},t.onEndAnimation=function(e,i){var n=function(e){if(t.support.transitions){if(e.target!=this)return;this.removeEventListener(t.animEndEventName,n)}i&&"function"==typeof i&&i.call(this)};t.support.transitions?e.addEventListener(t.animEndEventName,n):n()},t.onLoadImage=function(e,t){function i(){r||(r=!0,t(!0))}function n(){t(!1)}var o=new Image,r=!1;o.src=e,o.onerror=n,o.onload=i,o.complete&&i()},t.getSizeImage=function(e,t){function i(){r||(r=!0,t(o.naturalWidth,o.naturalHeight))}function n(){t(!1)}var o=new Image,r=!1;o.src=e,o.onerror=n,o.onload=i,o.complete&&i()},t.getScroll=function(e){var t=e.x*-1,i=e.y*-1,n=e.maxScrollX*-1,o=e.maxScrollY*-1;return{x:t,y:i,maxX:n,maxY:o}},t.throttle=function(e,t){var i=!0;return function(n){i&&(i=!1,setTimeout(function(){i=!0},t),e(n))}},t.debounce=function(e,t,i,n){3==arguments.length&&"boolean"!=typeof i&&(n=i,i=!1);var o;return function(){var r=arguments;n=n||this,i&&!o&&e.apply(n,r),clearTimeout(o),o=setTimeout(function(){!i&&e.apply(n,r),o=null},t)}},t.indexOf=function(e,t,i){for(var n=i||0,o=(e||[]).length;n<o;n++)if(e[n]==t)return n;return-1},t.inArray=function(e,i){return t.indexOf(e,i)!=-1},t.trim=function(e){return(e||"").replace(/^\s+|\s+$/g,"")},t.underscored=function(e){return t.trim(e).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},t.numberFormat=function(e,t,i,n){if(isNaN(e)||null==e)return"";e=parseInt(e).toFixed(~~t),n="string"==typeof n?n:",";var o=e.split("."),r=o[0],a=o[1]?(i||".")+o[1]:"";return r.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+n)+a},t.clean=function(e,i){return e=_.escape(t.trim(e)),e?e:i?i:null},t.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},t.isEmail=function(e){return e.match(/.+@.+\..+/i)},t.newId=function(){return String(Math.round((new Date).getTime()/1e3))},t.getDateNow=function(){var e=new Date,t=e.getHours(),i=e.getMinutes(),n=e.getSeconds(),o=e.getMonth()+1,r=e.getDate(),a=e.getFullYear();return t<10&&(t="0"+t),i<10&&(i="0"+i),n<10&&(n="0"+n),o<10&&(o="0"+o),r<10&&(r="0"+r),a+"-"+o+"-"+r+" "+t+":"+i+":"+n},t.bbUpdate=function(e,t){e.on("update",function(e){var i=e.data&&e.data.transaction&&e.data.transaction.length&&e.data.transaction[0].path?e.data.transaction[0].path[0]:null,n=e.data&&e.data.transaction&&e.data.transaction.length?e.data.transaction[0].value:null;t(i,n,e)})},window._?_.extend(_,t):window._=t,e.utils=window._}(app,app.utils),function(){app.url=function(){return app.config.domain+app.config.api},app.fetch=function(e){var t=[],n=[],o=e.split(", ");return new Promise(function(e,r){for(i=0;i<o.length;i++)_.isFunction(app.fetch.API[o[i]])&&t.push(o[i]);o.length!==t.length&&(n=_.difference(o,t)),Promise.all(t.map(app.fetch.API).concat(n.map(app.request))).then(function(t){e(t)})})},app.request=function(e,t){return new Promise(function(i,n){var o=_.underscored(e).replace(/^(get|set|add|del)/g,"").replace(/_/g,"/"),r=null;if(e.match(/^get/)?r="GET":e.match(/^set/)?r="PUT":e.match(/^add/)?r="POST":e.match(/^del/)&&(r="DELETE"),!r)return void n("Error type request: "+e);"GET"===r&&t&&(o+="/"+t,t=null),window.$LoaderAjax&&$LoaderAjax.show();var a=new XMLHttpRequest;a.open(r,app.url()+o,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-Type","application/json");try{app.request.list&&app.request.list.method===e&&app.request.list.params==JSON.stringify(t)&&app.request.list.xhr.abort(),a.send(t?JSON.stringify(t):{})}catch(e){}a.onload=function(e){try{if(200==this.status){var t=JSON.parse(this.response);i("OK"===t.status&&t.result?t.result:t)}else{app.errHandler(this.status);var o=new Error(this.statusText);o.code=this.status,n(o)}}catch(e){}app.request.list={},window.$LoaderAjax&&$LoaderAjax.hide()},a.onerror=function(){n(new Error("Network Error")),window.$LoaderAjax&&$LoaderAjax.hide()};try{app.request.list={method:e,xhr:a,params:JSON.stringify(t)}}catch(e){}})},app.errHandler=function(e){401==e?window.$Notify?$Notify.show({color:"info",text:"Авторизируйтесь снова"}):alert("Авторизируйтесь снова"):window.$Notify?$Notify.show({color:"danger",text:"Ошибка проведения операции повторите ее чуть позже"}):alert("Ошибка проведения операции повторите ее чуть позже")},window.onerror=function(e,t,i){app&&app.config&&app.config.logger&&app.config.logger.report&&app.request(app.config.logger.method,{msg:e,line:i,url:t,date:_.getDateNow(),version:null,platform:null,type:"error"})}}(),app.fetch.API=function(e){return app.fetch.API[e]()},app.fetch.API.getDataInit=function(){return new Promise(function(e,t){app.request("getDataInit").then(function(t){$store.products.set(t.products?t.products:[]),$store.packages.set(t.packages?t.packages:[]),e(t)})})},app.config={domain:"",api:"/public/api",logger:{method:"addLog",report:!1},changeStyles:!0},function(e){e.define("plugins.tutorial.podbor"),e.plugins.tutorial.podbor=[function(){return{figure:"square",target:"section-packages-select",position:"down",padding:20,title:"Выбор готовых наборов",text:"Вы можете выбрать готовые наборы компонентов. Все наборы прошли тщательный отбор и сохраняют отличный баланс между ценой и предложением."}},function(){return{figure:"square",target:"product-item[data-product='ledribbon']",position:"right",padding:10,title:"Светодиодная лента",text:'Мы вам предлагаем пройти обзор по интерфейсу. Это займет не более одной минуты. Перед вами один из трех и основной компонент набора, светодиодная лента. Фото, описание, класс и указание цены за метр. Чтобы перейти на следующий шаг нажмите "Далее".'}},function(){return{figure:"circle",target:"product-item[data-product='ledribbon'] .product__select",position:"right",padding:20,title:"Открыть предложения",text:"Открываем предложения светодиодных лент. Мы подготовили для вас несколько вариантов для каждого из компонентов. Сейчас ваши действия не активны, но после прохождения обзора вы сможете все выбрать."}},function(){return{figure:"square",target:"product-item[data-product='power']",position:"left",padding:30,actions:{toggle:function(e){$Product.ledribbon.tags["products-list"].toggle()}},title:"Предложения",text:'Предложения поделены на группы: "LUX", "Норма" и "Эконом". Вы можете выбрать любое предложение ориентируясь на свой бюджет. На самом деле вариантов гораздо больше, вы сможете настроить требуемые параметры и предложения сразу адаптируются под ваши требования.'}},function(){return{figure:"circle",target:"product-item[data-product='power'] .connect__control",position:"left",padding:30,activeZone:!0,title:"Управление освещением",text:"Если вам не требуется управлять своим будущим освещением, просто нажмите на эту кнопку."}},function(){return{figure:"square",target:"control-light",position:"right",width:380,height:170,offset:{top:-67},actions:{toggle:function(e){$Control.light.toggle()}},title:"Тип освещенности",text:'Варианты освещенности вашей подстветки, это: "монохромная", "мультицветная" или "бегущий огонь".'}},function(){return{figure:"square",target:"control-length",position:"right",width:400,height:170,offset:{top:-67},actions:{toggle:function(e){$Control.length.toggle()}},title:"Длина ленты",text:"Один из наиболее важных параметров. Измерьте требуемую длину для светодиодной ленты. Изменив, длину вы получите новые предложения по всем компонентам, максимально отвечающим вашим новым требованиям."}},function(){return{figure:"square",target:"control-color",position:"right",width:620,height:170,offset:{top:-67},actions:{toggle:function(e){$Control.color.toggle()}},title:"Цвет освещения",text:"Вы можете выбрать нужный вам цвет вашего освещения."}},function(){return{figure:"square",target:"control-humidity",position:"right",width:380,height:170,offset:{top:-67},actions:{toggle:function(e){$Control.humidity.toggle()}},title:"Влагозащищенность",text:"Выбор влагозащищенности ваших компонентов от брызгов воды или попадания под струю воды."}},function(){return{figure:"square",target:".section__control .total",position:"right",padding:20,title:"Итоговая цена",text:"Итоговая цена за весь выбранный комплект."}},function(){return{figure:"circle",target:".control .button__ok",position:"right",padding:15,title:'Кнопка "Все ОК!"',text:"После того, как вы закончите свой выбор, нажмите на эту кнопку, чтобы отправить предзаказ и связаться с нашим менеджером для дальнейшей консультации.\n Приятного Вам освещения!"}},function(){return{figure:"circle",target:"section-menu .menu__item[data-item='email']",position:"left",title:"Отправить расчет",text:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}},function(){return{figure:"circle",target:"section-menu .menu__item[data-item='order']",position:"left",title:"Отправить предзаказ",text:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}},function(){return{figure:"circle",target:"section-menu .menu__item[data-item='payment']",position:"left",title:"Оплатить заказ",text:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}},function(){return{figure:"circle",target:"section-menu .menu__item[data-item='callback']",position:"left",title:"Заказать звонок",text:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."}}]}(app),function(e,t,i,n,o){e.define("router"),e.router={base:"#",start:!1,init:function(){window.route&&(riot.route=window.route),riot.route("/",function(){o.isEmpty(r.params.get())?r.mount("begin"):r.mount("podbor")}),riot.route("podbor",function(){r.mount("podbor")}),riot.route.base(this.base),riot.route.start(!0)},params:{get:function(){return Url.parseQuery()},set:function(e){Url.updateSearchParam(e)}},nav:function(e){riot.route(e)},mount:function(t){r.start||(e.compatible?e.compatible.init(r.render,t):r.render(t))},render:function(t){var n=i.body.find("#loader"),a=riot.mount(".screens","screens"+(e.device.isPhone?"-mobile":""))[0];a.one("updated",function(){$afterlag.run(function(){i.body.removeClass("appLoading"),o.onEndTransition(n[0],function(){n.remove()})},{iterations:"podbor"==t?7:2,timeout:"podbor"==t?2e3:500}),$afterlag.run(function(){$Screens[t].show()},{iterations:3,timeout:1e3}),r.start=!0})}};var r=e.router;$Router=e.router}(app,$$,app.$dom,app.events,app.utils),function(e,t,i,n,o){e.define("plugins.styles"),e.plugins.styles={ready:!1,init:function(i){r.ready||(this.el=t(i.elem),this.screen=i.default,this.screens=i.screens,this.callback=i.callback,r.resizer(e.$dom.window[0].innerWidth),e.$dom.window.on("resize.styles",function(){r.resizer(this.innerWidth).length&&r.callback&&r.callback(r.screen)}),r.ready=!0)},resizer:function(e){return o.filter(r.screens,function(t){if((t.minWidth&&t.maxWidth&&e>t.minWidth-1&&e<t.maxWidth+1||t.minWidth&&!t.maxWidth&&e>t.minWidth||t.maxWidth&&!t.minWidth&&e<t.maxWidth)&&r.screen!==t.title)return t.reload&&r.ready?window.location.reload():t.path&&r.el.attr("href",t.path),r.screen=t.title,console.log("resize: "+t.title),r.screen})}};var r=e.plugins.styles}(app,$,app.$dom,app.events,app.utils),function(e,t,i,n,o){e.define("plugins.animate"),e.plugins.animate=function(e,i){var n=this;this.groups=[],this.options=i,this.scope=t(e),this.scope.find("*").each(function(){var e=this.getAttribute("class");if(e&&e.match(/anim-group/)){var t=e.match(/anim-group(\d+)/)[1],i=e.match(/anim-delay-(\w+)/),r=o.findWhere(n.groups,{num:t}),a={elem:this,delay:i&&i.length&&i[1]?n.delay.getNumByTitle(i[1]):"0"};r?r.items.push(a):n.groups.push({num:t,items:[a]})}})},e.plugins.animate.prototype={show:function(e){var t=this;this.groups.length&&o.each(o.sortArray(this.groups,"num"),function(i,n){!function(){if(t.groups[n+1]){var r=null,a=null;t.options&&t.options.showAfter?(r=o.sortArray(i.items,"delay","asc"),a=r[t.options.showAfter-1].elem):(r=o.sortArray(i.items,"delay","desc"),a=r[0].elem),a&&o.onEndTransition(a,function(){t.scope.addClass("showAnim-group"+(1*i.num+1)),t.groups.length==1*i.num+1&&o.isFunction(e)&&e()})}}(i,n),0==n&&t.scope.addClass("showAnim-group"+i.num)})},hide:function(e){if(this.groups.length&&(this.scope.removeClass(o.map(o.pluck(this.groups,"num"),function(e){return"showAnim-group"+e}).join(" ")),o.isFunction(e))){var t=o.sortArray(this.groups[0].items,"delay","desc")[0].elem;o.onEndTransition(t,function(){e()})}},delay:{items:[{title:"xs",num:"1"},{title:"s",num:"2"},{title:"m",num:"3"},{title:"l",num:"4"},{title:"xl",num:"5"}],getNumByTitle:function(e){return o.findWhere(this.items,{title:e}).num}}}}(app,$,app.$dom,app.events,app.utils),app.plugins.marquee=function(e,t){var i=e.find(t.screens),n=$('<div class="'+t.spaceClass+'" />').prependTo(e),o=[],r=app.effects[t.effect],a=(e.data("name"),{index:0,prevIndex:0,progress:0,size:0,scrolling:!1,enabled:!0,section:null,_events:{},on:function(e,t){this._events[e]||(this._events[e]=[]),this._events[e].push(t)},off:function(e,t){if(this._events[e]){var i=this._events[e].indexOf(t);i>-1&&this._events[e].splice(i,1)}},_execEvent:function(e){if(this._events[e]){var t=0,i=this._events[e].length;if(i)for(;t<i;t++)this._events[e][t].apply(this,[].slice.call(arguments,1))}}});i.each(function(e){var i=$(this),r=i.api("screen");r.state={isVisible:!1,isEndShow:!1,isStartShow:!1,isFullShow:!1,isFullHide:!0};var a={index:e,block:i,fake:$('<div class="'+t.spaceClass+'__screen" />'),api:r,ratio:1,enable:!0};o.push(a),n.append(a.fake)});var s=function(){var e=0;a.size=t.vertical?app.sizes.height:app.sizes.width,$.each(o,function(i,n){if(t.vertical){var o=Math.max(n.block.outerHeight(),n.block.find(t.contentClass?"."+t.contentClass:".screen__frame").outerHeight());o>a.size?(n.block.addClass(t.longClass?t.longClass:"screen__long"),n.size=o):(n.block.removeClass(t.longClass?t.longClass:"screen__long"),n.size=app.sizes.height),n.fake.width(app.sizes.width),n.fake.height(n.size),i>0&&t.hideSections&&n.block.css("display","none")}else n.size=app.sizes.width,n.fake.width(n.size),n.fake.height(app.sizes.height);n.offset=e,n.ratio=n.size/a.size,e+=n.size})};s();var l=new IScroll(e[0],{marquee:!0,disableMouse:!1,mouseWheel:t.mousewheel,scrollX:!t.vertical,scrollY:t.vertical,bounce:!0,snap:"."+t.spaceClass+"__screen",eventPassthrough:!t.vertical||"horizontal",probeType:3,snapSpeed:t.duration,preventDefault:!0,scrollbars:!!t.vertical&&"custom",interactiveScrollbars:t.vertical&&!app.device.support.touch,fake:!0});a.setLimits=function(e){e=Math.min(Math.max(0,e),o.length-1);var i=e>=o.length-1,n=0==e;l[t.vertical?"minScrollY":"minScrollX"]=-o[e].offset+(n?0:o[e-1].size),l[t.vertical?"maxScrollY":"maxScrollX"]=-o[e].offset-(i?o[e].size-a.size:o[e].size),l.currentPage={x:0,y:0,pageX:0,pageY:0},l.currentPage[t.vertical?"y":"x"]=-o[e].offset,l.currentPage[t.vertical?"pageY":"pageX"]=e},a.update=function(){for(var e=-Math.round(l[t.vertical?"y":"x"]),i=0,n=0;n<o.length;n++)e>=o[n].offset&&(i=n);a.position=(e-o[i].offset)/o[i].size,a.progress=i+a.position,a.index!=i&&(a.prevIndex=a.index,a.index=i)},a.hideInvisibles=function(){for(var e=0;e<o.length;e++)e!=a.index&&e!=a.index+1&&(e>a.index+1&&r.show(o[e].block,0,a.size,o[e].ratio),e<a.index&&r.hide(o[e].block,1,a.size,o[e].ratio),t.hideSections&&(o[e].block[0].style.display="none"))},a.callScreensAPI=function(){var e=a.index>=o.length-1,i=1/o[a.index].ratio,n={top:0,bottom:0};if(n.top=a.position/i,n.bottom=a.position*o[a.index].ratio-(o[a.index].ratio-1),n.bottom>.6?(o[a.index].api.state.isVisible&&(o[a.index].api.state.isVisible=!1,o[a.index].block.triggerHandler("hide")),e||o[a.index+1].api.state.isVisible||(o[a.index+1].api.state.isVisible=!0,o[a.index+1].block.triggerHandler("show"))):n.top>.4&&(o[a.index]&&!o[a.index].api.state.isVisible&&(o[a.index].api.state.isVisible=!0,o[a.index].block.triggerHandler("show")),!e&&o[a.index+1].api.state.isVisible&&(o[a.index+1].api.state.isVisible=!1,o[a.index+1].block.triggerHandler("hide"))),e||(n.bottom>.1&&!o[a.index+1].api.state.isStartShow?(o[a.index+1].api.state.isStartShow=!0,o[a.index+1].block.triggerHandler("startShow")):n.bottom<.1&&o[a.index+1].api.state.isStartShow&&(o[a.index+1].api.state.isStartShow=!1),n.bottom>.9&&!o[a.index+1].api.state.isEndShow?(o[a.index+1].api.state.isEndShow=!0,o[a.index+1].block.triggerHandler("endShow")):n.bottom<.9&&o[a.index+1].api.state.isEndShow&&(o[a.index+1].api.state.isEndShow=!1)),o[a.index]&&n.bottom<.9&&!o[a.index].api.state.isEndShow?(o[a.index].api.state.isEndShow=!0,o[a.index].block.triggerHandler("endShow")):o[a.index]&&n.bottom>.9&&o[a.index].api.state.isEndShow&&(o[a.index].api.state.isEndShow=!1),o[a.index]&&n.bottom<.1&&!o[a.index].api.state.isStartShow?(o[a.index].api.state.isStartShow=!0,o[a.index].block.triggerHandler("startShow")):o[a.index]&&n.bottom>.1&&o[a.index].api.state.isStartShow&&(o[a.index].api.state.isStartShow=!1),o[a.index]&&n.top>=0&&n.bottom<=0){o[a.index].api.state.isFullShow||(o[a.index].api.state.isFullShow=!0,o[a.index].block.triggerHandler("fullShow"));for(var r=0;r<o.length;r++)r!=a.index&&(o[r].api.state.isFullShow=!1)}else for(var r=0;r<o.length;r++)o[r].api.state.isFullShow=!1;for(var s=[Math.floor(a.progress),Math.ceil(a.progress)],r=0;r<o.length;r++)r==s[0]||r==s[1]?(o[r].api.state.isFullHide=!1,t.hideSections&&(o[r].block[0].style.display="block"),a.section=o[r].block[0].getAttribute("data-"+(t.dataAttr?t.dataAttr:"marquee")),t.activeClass&&o[r].block.addClass(t.activeClass)):o[r].api.state.isFullHide||(t.hideSections&&(o[r].block[0].style.display="none"),o[r].block.triggerHandler("fullHide"),o[r].api.state.isFullHide=!0,t.activeClass&&o[r].block.removeClass(t.activeClass))},a.markNav=function(){t.navPrev&&t.navPrev[a.progress<=.5?"addClass":"removeClass"]("i-disabled"),t.navNext&&t.navNext[a.progress>=o.length-1.5?"addClass":"removeClass"]("i-disabled")},a.draw=function(){if(!r.move||o[a.index].ratio*a.position>=o[a.index].ratio-1){var e=1-Math.abs(o[a.index].ratio*a.position-o[a.index].ratio);a.index>=0&&r.hide(o[a.index].block,e,a.size,o[a.index].ratio),a.index<o.length-1&&r.show(o[a.index+1].block,e,a.size,o[a.index+1].ratio),0!==e&&1!==e||a._execEvent("change")}else a.index>=0&&r.move(o[a.index].block,o[a.index].ratio*a.position,a.size,o[a.index].ratio),a.index<o.length-1&&r.show(o[a.index+1].block,0,a.size,o[a.index+1].ratio);a.hideInvisibles(),a.markNav()},a.onScrollStart=function(){a.scrolling=!0},a.onScroll=function(){if(index=0,a.update(),a.draw(),a.callScreensAPI(),l.moved){for(var e=l[t.vertical?"y":"x"]-l[t.vertical?"pointY":"pointX"],i=0;i<o.length;i++)e<=-o[i].offset&&e>=-o[i].offset-o[i].size&&(index=i);a.setLimits(index)}else if(l.indicators&&l.indicators[0].moved){for(var i=0;i<o.length;i++)l[t.vertical?"y":"x"]-a.size/2<=-o[i].offset&&l[t.vertical?"y":"x"]+a.size/2>=-o[i].offset-o[i].size&&(index=i);a.setLimits(index)}},a.grabTimer=!1;var c=function(){clearTimeout(a.grabTimer),a.scrolling||(a.scrolling=!0)},d=function(){a&&clearTimeout(a.grabTimer),a&&a.scrolling&&(a.scrolling=!1)};if(l.on("beforeWheelSnap",function(){index=0;for(var e=0;e<o.length;e++)l[t.vertical?"y":"x"]-a.size/2<=-o[e].offset&&l[t.vertical?"y":"x"]+a.size/2>=-o[e].offset-o[e].size&&(index=e);l.absStartX=t.vertical?0:-o[index].offset,l.absStartY=-t.vertical?-o[index].offset:0,a.setLimits(index)}),a.onScrollEnd=function(){a.refresh()},a.refresh=function(){a.update(),a.draw(),a.callScreensAPI(),a.setLimits(a.index)},a.resize=function(){if(!a)return!1;s();var e=l.y;l.refresh(),e!==l.y&&l.scrollBy(0,e-l.y,0),a.refresh()},a.enable=function(){a.enabled=!0,l.enable(),a.enableKeyboard()},a.disable=function(){a.enabled=!1,l.disable(),a.disableKeyboard()},l.on("scrollStart",function(){return!!a&&void a.onScrollStart()}),l.on("scroll",function(){return!!a&&(a.onScroll(),void(l.moved&&c()))}),l.on("scrollEnd",function(){return!!a&&(a.onScrollEnd(),void d())}),l.on("grab",function(){if(!a)return!1;c(),a.grabTimer=setTimeout(function(){l&&l.reset(),d()},500);for(var e=0,i=l[t.vertical?"y":"x"]-l[t.vertical?"pointY":"pointX"],n=0;n<o.length;n++)i<=-o[n].offset&&i>=-o[n].offset-o[n].size&&(e=n);a.setLimits(e)}),app.$dom.window.on("resize",a.resize),a.setLimits(0),a.scrollTo=function(e,i){i=void 0===i&&0!==i?550:i,t.hideSections&&(o[e].block[0].style.display="block"),setTimeout(function(){l.goToPage(t.vertical?0:e,t.vertical?e:0,i,IScroll.utils.ease.cubicOut),0==i&&a.refresh()},5)},a.prev=function(e){if(a.scrolling)return!1;e=void 0===e?t.duration:e;var i=-l.y-o[a.index].offset;t.vertical&&i?l.scrollBy(0,Math.min(i,a.size),e,IScroll.utils.ease.cubicOut):t.vertical&&l.y<=-a.size?l.scrollBy(0,a.size,e,IScroll.utils.ease.cubicOut):a.index>0&&l.prev(e,IScroll.utils.ease.cubicOut)},a.next=function(e){if(a.scrolling)return!1;e=void 0===e?t.duration:e;var i=o[a.index].offset+o[a.index].size-(-l.y+a.size);i>.1*a.size&&t.vertical?l.scrollBy(0,-Math.min(i,a.size),e,IScroll.utils.ease.cubicOut):a.index<o.length-1&&l.next(e,IScroll.utils.ease.cubicOut);
},a.get=function(e){return a[e]},a.hideScreen=function(e,t){f[e].enable&&(f[e].enable=!1,a.callScreensVisible(),t&&a.resize())},a.showScreen=function(e,t){f[e].enable||(f[e].enable=!0,a.callScreensVisible(),t&&a.resize())},a.callScreensVisible=function(){for(var e=[],t=0;t<f.length;t++)f[t].enable&&e.push(f[t]);e.length!==o.length&&(o=e)},a.destroy=function(){e.find("."+t.spaceClass).remove(),e.removeData("marquee"),l.destroy(),l=null,a=null},t.vertical){var u=e.find(".iScrollVerticalScrollbar");u.addClass("ui-scroll").prepend('<div class="ui-scroll__bar" />'),u.find(".iScrollIndicator").addClass("ui-scroll__handle").prepend('<div class="ui-scroll__handle__inner" />')}t.navPrev&&t.navPrev.on("click",function(){a.prev(app.device.isPhone?500:700)}),t.navNext&&t.navNext.on("click",function(){a.next(app.device.isPhone?500:700)});var p="keydown.marquee-"+String(Math.round((new Date).getTime()/1e3))+(t.vertical?"v":"h");if(a.enableKeyboard=function(){app.device.support.touch||app.$dom.document.on(p,function(e){$(e.target).is("input,textarea,select")||(e.which==(t.vertical?38:37)&&a.prev(app.device.isPhone?500:700),e.which==(t.vertical?40:39)&&a.next(app.device.isPhone?500:700))})},a.disableKeyboard=function(){app.device.support.touch||app.$dom.document.off(p)},a.scroll=l,t.controlInvisible)for(var f=[],h=0;h<o.length;h++)f.push(o[h]);return e.data("marquee",{screens:o,onScrollStart:$.noop,onScrollEnd:$.noop,scrollTo:a.scrollTo,get:a.get,scroll:l,update:a.onScroll,resize:a.resize,enable:a.enable,disable:a.disable,destroy:a.destroy,enableKeyboard:a.enableKeyboard,disableKeyboard:a.disableKeyboard}),a},function(e,t,i,n,o){e.define("plugins.screens"),e.plugins.screens=function(e,i){this.active=!1,this.scope=t(e),this.options=i||{},this.state=null,this.items=[]},e.plugins.screens.prototype={init:function(t){var i=this;if(!this.active){this.scope.on("touchmove MSPointerMove",function(e){e.preventDefault()}),this.scope.on("dragstart selectstart",function(){return!1});var n={vertical:!0,screens:".screen",effect:this.options.vertical===!1?"space":"light",mousewheel:this.options.vertical!==!1,spaceClass:this.options.vertical===!1?"horizontal__space":"vertical__space",longClass:this.options.vertical!==!1&&"screen--long",contentClass:this.options.vertical!==!1&&"screen__content",hideSections:!0,navPrev:this.options.navPrev,navNext:this.options.navNext,duration:this.options.vertical===!1?e.device.isPhone?375:450:500};this.options&&o.extend(n,this.options);var r=100;this.scope.find(n.screens).each(function(e){i.items[this.getAttribute("data-marquee")]=e,n.vertical||(this.style.zIndex=r),r--}),this.marquee=e.plugins.marquee(this.scope,n),this.marquee.enable(),this.marquee.scroll.on("scrollEnd",function(){i.state=i.marquee.section}),t&&this.nav(t,0),this.active=!0}},nav:function(e,t){if(e){var i=this.items[e];void 0!==i&&(this.state=e,this.marquee.scrollTo(i,void 0!==t?t:void 0))}},get:function(e){return this.marquee[e]},refresh:function(){this.marquee.resize()},destroy:function(){this.scope.off(),this.marquee.scroll.off(),this.marquee.destroy(),this.active=!1}}}(app,$,app.$dom,app.events,app.utils),$store.products=_.extend(new Baobab([]),{getItemsByParams:function(e,t){return _.filter(t?t:$store.products.get(),function(t){return t.light==e.light&&t.type==e.type&&t.length==String(e.length)&&t.group==e.group})},getItemsByParamsWithoutGroup:function(e,t){return _.filter(t?t:$store.products.get(),function(t){return t.light==e.light&&t.type==e.type&&t.length==String(e.length)})},existItemsByParamsWithoutGroup:function(e,t){return!_.isEmpty(_.findWhere($store.products.getItemsByParamsWithoutGroup(e),{article:t}))},getItemsByParamsWithoutType:function(e,t){return _.filter(t?t:$store.products.get(),function(t){return t.light==e.light&&t.length==String(e.length)&&t.group==e.group})},getItemByArticle:function(e){return $store.products.select({article:e}).get()},getImageByArticle:function(e){return e?"http://ledtop-shop.ru/files/catalog/"+e+".jpg":null}}),$store.packages=_.extend(new Baobab([]),{getItemsByParams:function(e,t){return _.filter(t?t:$store.packages.get(),function(t){return t.light==e.light&&t.length==String(e.length)&&t.group==e.group&&(!_.isBoolean(e.active)||e.active===t.active)})},getItemById:function(e,t){var i={_id:e};return t&&_.extend(i,t),$store.packages.select(i).get()},getTitleById:function(e){return $store.packages.select({_id:e}).get("title")},getPrice:function(e,t){var i=$store.packages.get({_id:e}),n=0,o={ledribbon:$store.products.getItemByArticle(i.ledribbon),power:$store.products.getItemByArticle(i.power),control:$store.products.getItemByArticle(i.control)};return n+=o.ledribbon?o.ledribbon.price*t:0,n+=o.power?o.power.price:0,n+=o.control?o.control.price:0}}),$store.light=_.extend(new Baobab([{_id:"1",title:"Монохромная"},{_id:"2",title:"Мультицветная"},{_id:"3",title:"Бегущий огонь"}]),{getTitleById:function(e){return _.findWhere($store.light.get(),{_id:e}).title}}),$store.type=_.extend(new Baobab([{_id:"ledribbon",title:"Лента"},{_id:"power",title:"Питание"},{_id:"control",title:"Управление"}]),{getTitleById:function(e){return _.findWhere($store.type.get(),{_id:e}).title}}),$store.group=_.extend(new Baobab([{_id:"econom",title:"Эконом"},{_id:"norm",title:"Норма"},{_id:"lux",title:"LUX"}]),{getTitleById:function(e){return _.findWhere($store.group.get(),{_id:e}).title}}),$store.data=_.extend(new Baobab([{_id:"ledribbon",title:"Лента",product:null,products:null},{_id:"power",title:"Блок питания",product:null,products:null},{_id:"control",title:"Управление",product:null,products:null}],{autoCommit:!0}),{setProduct:function(e){$store.data.select({_id:e.type},"product").set(e)},setProducts:function(e){_.each(e,function(e,t){$store.data.select({_id:t},"product").set($store.products.getItemByArticle(e))})},setProductsAll:function(e){_.each(e,function(e,t){$store.data.select({_id:t},"products").set(e)})},getProductCursor:function(e){return $store.data.select({_id:e})},getProduct:function(e){return $store.data.get({_id:e},"product")},getProducts:function(e){return $store.data.get({_id:e},"products")},getProductsByGroup:function(e,t){return _.where($store.data.get({_id:e},"products"),{group:t})},getProductsCount:function(e){var t=$store.data.get({_id:e},"products");return t?t.length:0}}),$store.humidity=_.extend(new Baobab([]),{setStore:function(){var e=[];_.each($store.data.getProducts("ledribbon"),function(t){t.hum&&!_.findWhere(e,{hum:t.hum})&&e.push({article:t.article,hum:t.hum})}),$store.humidity.set(e)}}),$store.color=_.extend(new Baobab([]),{setStore:function(){var e=[];related=_.compact(_.flatten(_.pluck($store.data.getProducts("ledribbon"),"related"))),_.each(related,function(t){_.findWhere(e,{color:t.color})||e.push(t)}),_.each($store.data.getProducts("ledribbon"),function(t){_.findWhere(e,{color:t.color})||e.push({article:t.article,color:t.color})}),$store.color.set(e)}}),$store.order=_.extend(new Baobab([]),{getData:function(){}});